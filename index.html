<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGen AI | Ø£Ù†Ø´Ø¦ Ù…ÙˆÙ‚Ø¹Ùƒ ÙÙŠ 60 Ø«Ø§Ù†ÙŠØ©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        /* Custom Styles and Colors (Cohesive Theme) */
        :root {
            --primary-blue: #3B82F6; /* Indigo/Blue */
            --secondary-purple: #9333EA; /* Deep Purple */
            --light-blue: #E0E7FF; /* Blue-100 */
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f6f9; /* Soft background */
            color: #1F2937;
        }
        /* Gradient for CTA and Highlights */
        .cta-gradient {
            background-image: linear-gradient(to right, var(--primary-blue), var(--secondary-purple));
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .cta-gradient:hover {
            transform: scale(1.03);
            box-shadow: 0 10px 20px -5px rgba(59, 130, 246, 0.5);
        }

        /* App UI Styles */
        .app-container {
            /* Max width for responsive design (looks like a phone app on desktop) */
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background-color: white; /* Clean white background */
        }
        .app-input {
            border: 2px solid #E5E7EB;
            transition: border-color 0.3s, box-shadow 0.3s;
            background-color: #F9FAFB;
        }
        .app-input:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.5);
            background-color: white;
        }
        /* Progress Bar Styling */
        .step-indicator {
            height: 6px;
            background-color: #E5E7EB;
            border-radius: 9999px;
            overflow: hidden;
        }
        .step-indicator-progress {
            background-image: linear-gradient(to right, #3B82F6, #9333EA);
            transition: width 0.5s ease-in-out;
            height: 100%;
        }
        /* Selectable Card Styling (Stage 2) */
        .app-card-select {
            border: 2px solid #F3F4F6;
            transition: all 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        .app-card-select:hover {
            border-color: #D1D5DB;
        }
        .app-card-select.selected {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px var(--light-blue);
            background-color: #F8FAFF;
        }
        /* Custom Switch Styling */
        .switch-toggle:checked {
            background-color: var(--primary-blue);
        }

        /* Input Collapse Animation */
        .input-collapse {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease-in-out, opacity 0.4s ease-in-out;
            opacity: 0;
            margin-top: 0;
        }
        .input-collapse.expanded {
            max-height: 100px; /* Adjust based on content height */
            opacity: 1;
            margin-top: 1rem;
        }

        /* Progress Circle styles for the app UI */
        .progress-ring {
            width: 150px;
            height: 150px;
        }
        .progress-ring__circle {
            transition: stroke-dashoffset 0.1s linear; /* Use linear for loading simulation */
            transform: rotate(-90deg);
            transform-origin: 50% 50%;
        }
        
        /* Final Result Section Styles */
        #final-result-section {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 24px;
        }
    </style>
</head>
<body class="antialiased">

    <div id="landing-page" class="max-w-md mx-auto">
        <header class="sticky top-0 z-10 bg-white shadow-sm">
            <div class="p-4 flex justify-between items-center">
                <div class="text-2xl font-extrabold cta-gradient bg-clip-text text-transparent">WebGen AI</div>
                <a href="#pricing-section" class="text-sm font-semibold text-gray-700 hover:text-indigo-600 transition flex items-center">
                    <i data-lucide="tag" class="w-4 h-4 ml-1"></i>
                    Ø§Ù„Ø£Ø³Ø¹Ø§Ø±
                </a>
            </div>
        </header>

        <main class="p-4 space-y-12 pb-16">
            <section class="text-center pt-8">
                <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full bg-indigo-100 text-indigo-700 mb-4">
                    Ø¬Ø¯ÙŠØ¯! Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ Ø¨Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
                </span>
                <h1 class="text-4xl font-extrabold leading-tight mb-4">
                    Ø£Ù†Ø´Ø¦ Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„<br> ÙÙŠ Ø£Ù‚Ù„ Ù…Ù† Ø¯Ù‚ÙŠÙ‚Ø©.
                </h1>
                <p class="text-xl text-gray-600 mb-8">
                    ØµÙØ­Ø© Ù‡Ø¨ÙˆØ·ØŒ Ù…ØªØ¬Ø±ØŒ Ø£Ùˆ Ù…Ø¹Ø±Ø¶ Ø£Ø¹Ù…Ø§Ù„. Ù„Ø§ ÙƒÙˆØ¯. Ù„Ø§ ØªØ¹Ù‚ÙŠØ¯. ÙÙ‚Ø· Ø§Ø¶ØºØ· ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„Ø¨ÙŠØ¹.
                </p>
                
                <button onclick="startApp()" class="w-full inline-flex items-center justify-center py-4 text-white text-lg font-bold rounded-xl cta-gradient shadow-lg">
                    <i data-lucide="rocket" class="w-6 h-6 ml-2"></i>
                    Ø§Ø¨Ø¯Ø£ Ù…Ø¬Ø§Ù†Ù‹Ø§ Ø§Ù„Ø¢Ù†!
                </button>
            </section>
            
            <section>
                <h2 class="text-2xl font-bold text-center mb-6">Ø³Ø±Ø¹Ø© Ù„Ø§ ØªØµØ¯Ù‚ ÙÙŠ Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡</h2>
                <div class="w-64 h-96 mx-auto rounded-3xl overflow-hidden shadow-2xl relative bg-white border-4 border-gray-100">
                    <img src="https://placehold.co/200x350/3B82F6/FFFFFF?text=AI+Builder+Preview" alt="ÙˆØ§Ø¬Ù‡Ø© ØªØ·Ø¨ÙŠÙ‚ WebGen AI Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø§ØªÙ" class="w-full h-full object-cover">
                    <span class="absolute top-2 left-2 px-2 py-1 bg-white text-gray-800 text-xs rounded-full shadow">Ø´Ø§Ù‡Ø¯ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</span>
                </div>
                <p class="text-center text-sm text-gray-500 mt-4 flex items-center justify-center">
                    <i data-lucide="check-circle" class="w-4 h-4 ml-1 text-green-500"></i>
                    Ù…ÙˆØ§Ù‚Ø¹ Ù…ÙØµÙ…Ù…Ø© Ù„Ø¬Ù…Ù‡ÙˆØ± ØªÙŠÙƒ ØªÙˆÙƒ.
                </p>
            </section>

            <section class="space-y-6">
                <h2 class="text-2xl font-bold text-center mb-6">Ù„Ù…Ø§Ø°Ø§ WebGen AI Ù‡Ùˆ Ø®ÙŠØ§Ø±Ùƒ Ø§Ù„Ø£ÙØ¶Ù„ØŸ</h2>
                <div class="flex items-start space-x-4 space-x-reverse p-4 bg-white rounded-xl shadow-md">
                    <div class="p-3 rounded-full bg-indigo-100 text-indigo-600">
                        <i data-lucide="dollar-sign" class="w-6 h-6"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-lg">ØªØ­ÙƒÙ… ÙƒØ§Ù…Ù„ ÙÙŠ Ø§Ù„Ø´Ø±Ø§Ø¡</h3>
                        <p class="text-gray-500 text-sm">Ø§Ø¬Ø¹Ù„ Ø¹Ù…ÙŠÙ„Ùƒ ÙŠØ´ØªØ±ÙŠ Ø¹Ø¨Ø± Ø±Ø§Ø¨Ø· Ù…Ø¨Ø§Ø´Ø± Ø£Ùˆ ÙŠØ±Ø³Ù„ Ù„Ùƒ Ø±Ø³Ø§Ù„Ø© Ø¹Ù„Ù‰ ÙˆØ§ØªØ³Ø§Ø¨ Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø·Ù„Ø¨.</p>
                    </div>
                </div>
                <div class="flex items-start space-x-4 space-x-reverse p-4 bg-white rounded-xl shadow-md">
                    <div class="p-3 rounded-full bg-indigo-100 text-indigo-600">
                        <i data-lucide="zap" class="w-6 h-6"></i>
                    </div>
                    <div>
                        <h3 class="font-semibold text-lg">Ø¬Ø§Ù‡Ø² Ù„Ù„Ù†Ø´Ø± Ø§Ù„ÙÙˆØ±ÙŠ</h3>
                        <p class="text-gray-500 text-sm">Ù…ÙˆÙ‚Ø¹ Ù…ÙØ­Ø³Ù‘Ù† Ù„Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¨Ø­Ø« (SEO) ÙˆÙŠØ¹Ù…Ù„ Ø¨Ø³Ø±Ø¹Ø© Ø§Ù„Ø¨Ø±Ù‚ Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù‡ÙˆØ§ØªÙ.</p>
                    </div>
                </div>
            </section>

            <section id="pricing-section" class="text-center bg-indigo-50 p-6 rounded-xl">
                 <h3 class="text-xl font-bold mb-4">Ø®Ø·ÙˆØªÙƒ Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù†Ø­Ùˆ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª ØªØ¨Ø¯Ø£ Ø§Ù„Ø¢Ù†!</h3>
                 <button onclick="startApp()" class="w-full py-4 text-white text-lg font-bold rounded-xl cta-gradient shadow-lg">
                    <i data-lucide="play" class="w-6 h-6 ml-2"></i>
                    Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¢Ù†
                 </button>
            </section>
        </main>

        <footer class="max-w-md mx-auto text-center py-6 text-sm text-gray-500 border-t mt-8">
            <p>Â© 2025 WebGen AI. Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</p>
            <div class="flex justify-center space-x-4 space-x-reverse mt-4 text-xs">
                <a href="#" class="hover:text-indigo-600">Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø®ØµÙˆØµÙŠØ©</a>
                <span>â€¢</span>
                <a href="#" class="hover:text-indigo-600">Ø´Ø±ÙˆØ· Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</a>
            </div>
        </footer>
    </div>

    <div id="webgen-app-ui" class="max-w-md mx-auto w-full hidden app-container shadow-2xl">
        <header class="sticky top-0 z-20 bg-white p-4 border-b border-gray-100">
            <div class="flex justify-between items-center mb-4">
                <button onclick="goBack()" class="text-gray-600 hover:text-indigo-600 transition hidden p-1">
                    <i data-lucide="chevron-right" class="w-6 h-6"></i>
                </button>
                <div class="text-xl font-bold cta-gradient bg-clip-text text-transparent">WebGen AI Builder</div>
                <div class="w-6 h-6"></div> 
            </div>
            
            <div class="flex justify-between text-xs font-semibold text-gray-500 mb-2">
                <span id="step-title-1" class="text-indigo-600">1. Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ§Øª</span>
                <span id="step-title-2">2. Ø§Ù„ÙØ¦Ø§Øª</span>
                <span id="step-title-3">3. Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</span>
                <span id="step-title-4">4. Ø§Ù„Ù†Ø´Ø±</span>
            </div>
            <div class="step-indicator">
                <div id="app-progress-bar" class="step-indicator-progress w-1/4"></div>
            </div>
        </header>

        <section id="app-stage-1" class="p-6 flex flex-col justify-between flex-grow">
            <div>
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Ø£ÙˆÙ„Ø§Ù‹: Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ù…ÙˆÙ‚Ø¹Ùƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h2>
                <p class="text-gray-500 mb-8">Ø³Ù†Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ù…ÙˆÙ‚Ø¹Ùƒ.</p>
                <form class="space-y-6">
                    <div>
                        <label for="app-site-name" class="block text-sm font-medium text-gray-700">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø£Ùˆ Ø§Ù„Ù†Ø´Ø§Ø· *</label>
                        <input type="text" id="app-site-name" class="mt-1 block w-full rounded-xl p-3 app-input" placeholder="Ù…Ø«Ø§Ù„: Ù…ØªØ¬Ø± Ø§Ù„Ø¬Ù…Ø§Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹">
                    </div>
                    <div>
                        <label for="app-website-type" class="block text-sm font-medium text-gray-700">Ù†ÙˆØ¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø°ÙŠ ØªØ±ÙŠØ¯ Ø¥Ù†Ø´Ø§Ø¦Ù‡ *</label>
                        <select id="app-website-type" class="mt-1 block w-full rounded-xl p-3 app-input appearance-none">
                            <option value="" disabled selected>Ø§Ø®ØªØ± Ù†ÙˆØ¹ Ø§Ù„Ù…ÙˆÙ‚Ø¹</option>
                            <option value="Affiliate">ØµÙØ­Ø© Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØ³ÙˆÙŠÙ‚ Ø¨Ø§Ù„Ø¹Ù…ÙˆÙ„Ø©</option>
                            <option value="Products">Ù…ØªØ¬Ø± Ù„Ø¹Ø±Ø¶ ÙˆØ¨ÙŠØ¹ Ù…Ù†ØªØ¬Ø§ØªÙŠ</option>
                            <option value="Showcase">ØµÙØ­Ø© Ù„Ø¹Ø±Ø¶ Ø®Ø¯Ù…Ø§ØªÙŠ Ø£Ùˆ Ù…Ø¹Ø±Ø¶ Ø£Ø¹Ù…Ø§Ù„</option>
                        </select>
                    </div>

                    <div class="space-y-4 pt-4 border-t border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-700">Ø±Ø¨Ø· Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªÙˆØ§ØµÙ„ (Ù„Ù„ØªÙˆØ§ØµÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹)</h3>
                        
                        <div class="flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border">
                            <label class="text-base text-gray-700 flex items-center">
                                <i data-lucide="instagram" class="w-5 h-5 ml-3 text-pink-500"></i>
                                Ø§Ù†Ø³ØªØºØ±Ø§Ù…
                            </label>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" data-link-id="instagram-link-container" onchange="toggleLinkField(this)" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-300 after:rounded-full after:h-5 after:w-5 after:transition-all switch-toggle"></div>
                            </label>
                        </div>
                        <div id="instagram-link-container" class="input-collapse">
                            <input type="url" id="app-instagram-link" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ø­Ø³Ø§Ø¨ Ø§Ù†Ø³ØªØºØ±Ø§Ù…" class="w-full rounded-xl p-3 app-input">
                        </div>

                        <div class="flex justify-between items-center bg-white p-4 rounded-xl shadow-sm border">
                            <label class="text-base text-gray-700 flex items-center">
                                <i data-lucide="message-square-text" class="w-5 h-5 ml-3 text-green-500"></i>
                                ÙˆØ§ØªØ³Ø§Ø¨
                            </label>
                            <label class="relative inline-flex items-center cursor-pointer">
                                <input type="checkbox" data-link-id="whatsapp-link-container" onchange="toggleLinkField(this)" class="sr-only peer">
                                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-300 after:rounded-full after:h-5 after:w-5 after:transition-all switch-toggle"></div>
                            </label>
                        </div>
                         <div id="whatsapp-link-container" class="input-collapse">
                            <input type="text" id="app-whatsapp-link" placeholder="Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¹ Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø© (Ù…Ø«Ø§Ù„: +9665XXXXXXXX)" class="w-full rounded-xl p-3 app-input">
                        </div>
                    </div>
                </form>
            </div>
            <button onclick="nextAppStage(2)" class="w-full py-4 text-white font-bold rounded-xl cta-gradient shadow-lg mt-10">Ø§Ù„ØªØ§Ù„ÙŠ: Ø§Ø®ØªØ± ÙØ¦Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
        </section>
        
        <section id="app-stage-2" class="p-6 flex flex-col justify-between flex-grow hidden">
            <div>
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Ø«Ø§Ù†ÙŠØ§Ù‹: Ù…Ø§ Ù‡ÙŠ ÙØ¦Ø§Øª Ù…Ù†ØªØ¬Ø§ØªÙƒ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©ØŸ</h2>
                <p class="text-gray-500 mb-8">Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø§Øª Ø§Ù„ØªÙŠ ØªØªØ­Ø¯Ø« Ø¹Ù†Ù‡Ø§ Ø¹Ù„Ù‰ ØªÙŠÙƒ ØªÙˆÙƒ Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø£Ù‚Ø³Ø§Ù….</p>
                <div class="grid grid-cols-2 gap-4">
                    <div onclick="selectCard(this)" class="app-card-select p-4 rounded-xl flex flex-col items-center cursor-pointer bg-white" data-category="Ù…Ù„Ø§Ø¨Ø³/Ø£Ø²ÙŠØ§Ø¡">
                        <i data-lucide="t-shirt" class="w-10 h-10 mb-2 text-indigo-500"></i>
                        <span class="text-sm font-medium text-gray-800">Ù…Ù„Ø§Ø¨Ø³/Ø£Ø²ÙŠØ§Ø¡</span>
                    </div>
                    <div onclick="selectCard(this)" class="app-card-select p-4 rounded-xl flex flex-col items-center cursor-pointer bg-white" data-category="Ø¬Ù…Ø§Ù„/Ø¹Ù†Ø§ÙŠØ©">
                        <i data-lucide="sparkles" class="w-10 h-10 mb-2 text-pink-500"></i>
                        <span class="text-sm font-medium text-gray-800">Ø¬Ù…Ø§Ù„/Ø¹Ù†Ø§ÙŠØ©</span>
                    </div>
                    <div onclick="selectCard(this)" class="app-card-select p-4 rounded-xl flex flex-col items-center cursor-pointer bg-white selected" data-category="Ù…Ø£ÙƒÙˆÙ„Ø§Øª/Ø­Ù„ÙˆÙŠØ§Øª">
                        <i data-lucide="cake" class="w-10 h-10 mb-2 text-yellow-500"></i>
                        <span class="text-sm font-medium text-gray-800">Ù…Ø£ÙƒÙˆÙ„Ø§Øª/Ø­Ù„ÙˆÙŠØ§Øª</span>
                    </div>
                    <div onclick="selectCard(this)" class="app-card-select p-4 rounded-xl flex flex-col items-center cursor-pointer bg-white" data-category="Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª">
                        <i data-lucide="monitor" class="w-10 h-10 mb-2 text-green-500"></i>
                        <span class="text-sm font-medium text-gray-800">Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Øª</span>
                    </div>
                    <div onclick="selectCard(this)" class="app-card-select p-4 rounded-xl flex flex-col items-center cursor-pointer bg-white" data-category="Ù…Ù†Ø²Ù„/Ø¯ÙŠÙƒÙˆØ±">
                        <i data-lucide="home" class="w-10 h-10 mb-2 text-blue-500"></i>
                        <span class="text-sm font-medium text-gray-800">Ù…Ù†Ø²Ù„/Ø¯ÙŠÙƒÙˆØ±</span>
                    </div>
                    <div onclick="selectCard(this)" class="app-card-select p-4 rounded-xl flex flex-col items-center cursor-pointer bg-white" data-category="Ø£Ø®Ø±Ù‰">
                        <i data-lucide="ellipsis" class="w-10 h-10 mb-2 text-gray-500"></i>
                        <span class="text-sm font-medium text-gray-800">Ø£Ø®Ø±Ù‰</span>
                    </div>
                </div>
            </div>
            <button onclick="nextAppStage(3)" class="w-full py-4 text-white font-bold rounded-xl cta-gradient shadow-lg mt-10">Ø§Ù„ØªØ§Ù„ÙŠ: Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</button>
        </section>

        <section id="app-stage-3" class="p-6 flex flex-col justify-between flex-grow hidden">
            <div>
                <h2 class="text-2xl font-bold mb-4 text-gray-800">Ø«Ø§Ù„Ø«Ø§Ù‹: ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬ (Ø§Ù„Ø£Ù‡Ù… Ù„Ù„Ù…Ø¨ÙŠØ¹Ø§Øª)</h2>
                <p class="text-gray-500 mb-8">Ø§Ù…Ù„Ø£ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ù†ØªØ¬ Ù„Ø¬Ø°Ø¨ Ø§Ù†ØªØ¨Ø§Ù‡ Ø§Ù„Ø¹Ù…ÙŠÙ„. (Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ Ù‡Ùˆ Ù…Ø«Ø§Ù„)</p>
                <div id="product-list" class="space-y-6">
                    <div class="product-item p-5 border border-gray-200 rounded-xl shadow-lg bg-white space-y-4">
                        
                        <input type="file" class="product-image-input hidden" accept="image/*" onchange="previewImage(this, this.parentNode.querySelector('.image-preview'), this.parentNode.querySelector('.placeholder-content'))">

                        <label class="image-upload-area flex justify-center items-center h-28 border-2 border-dashed border-gray-300 rounded-lg bg-gray-50 cursor-pointer hover:bg-gray-100 transition overflow-hidden relative" for="product-image-1">
                            <img class="image-preview w-full h-full object-cover absolute inset-0 hidden" src="" alt="Ù…Ø¹Ø§ÙŠÙ†Ø© ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬">
                            
                            <div class="placeholder-content text-center text-gray-500 z-10 p-2">
                                <i data-lucide="image-plus" class="mx-auto w-8 h-8"></i>
                                <p class="mt-1 text-sm font-medium">Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬ (Ø§Ø¶ØºØ· Ù„Ù„Ø±ÙØ¹)</p>
                            </div>
                        </label>
                        <input type="text" class="product-title-input w-full rounded-xl p-3 app-input" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù†ØªØ¬ (Ø¬Ø°Ø§Ø¨ ÙˆÙ…Ø®ØªØµØ±)" value="Ù…Ø§ÙƒÙŠÙ†Ø© Ø­Ù„Ø§Ù‚Ø© ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© ÙØ§Ø¦Ù‚Ø©">
                        <textarea class="product-desc-input w-full rounded-xl p-3 app-input" placeholder="ÙˆØµÙ Ø§Ù„Ù…Ù†ØªØ¬ (Ù‚ÙˆÙŠ ÙˆÙ…Ù‚Ù†Ø¹)" rows="3">ØªÙˆÙØ± Ø­Ù„Ø§Ù‚Ø© Ù†Ø§Ø¹Ù…Ø© ÙˆÙ…Ø±ÙŠØ­Ø© Ø¯ÙˆÙ† ØªÙ‡ÙŠØ¬ØŒ Ù…Ø¹ Ø¹Ù…Ø± Ø¨Ø·Ø§Ø±ÙŠØ© ÙŠØ¯ÙˆÙ… Ø·ÙˆÙŠÙ„Ø§Ù‹.</textarea>
                        
                        <div class="flex space-x-4 space-x-reverse">
                            <input type="number" class="product-price-input w-1/3 rounded-xl p-3 app-input" value="150" placeholder="Ø§Ù„Ø³Ø¹Ø±">
                            <select class="product-currency-input w-2/3 rounded-xl p-3 app-input appearance-none">
                                <option>Ø±ÙŠØ§Ù„ Ø³Ø¹ÙˆØ¯ÙŠ (SAR)</option>
                                <option>Ø¯ÙˆÙ„Ø§Ø± Ø£Ù…Ø±ÙŠÙƒÙŠ (USD)</option>
                                <option>Ø¯Ø±Ù‡Ù… Ø¥Ù…Ø§Ø±Ø§ØªÙŠ (AED)</option>
                                <option>Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ (EGP)</option>
                                <option>Ø¯ÙŠÙ†Ø§Ø± ÙƒÙˆÙŠØªÙŠ (KWD)</option>
                            </select>
                        </div>
                        
                        <div class="pt-2">
                            <h4 class="text-md font-semibold text-gray-700 mb-2">ÙƒÙŠÙ ÙŠØªÙ… Ø§Ù„Ø´Ø±Ø§Ø¡ØŸ</h4>
                            <div class="flex justify-between items-center p-3 rounded-lg border bg-blue-50">
                                <label class="text-base text-gray-700 flex items-center">
                                    <i data-lucide="external-link" class="w-5 h-5 ml-2 text-blue-600"></i>
                                    Ø±Ø§Ø¨Ø· Ø´Ø±Ø§Ø¡ Ù…Ø¨Ø§Ø´Ø± (Ù…Ø«Ù„ Ø£Ù…Ø§Ø²ÙˆÙ†/Ø³Ù„Ø©)
                                </label>
                                <label class="relative inline-flex items-center cursor-pointer">
                                    <input type="checkbox" data-link-id="product-link-container-1" onchange="toggleLinkField(this)" class="sr-only peer" checked>
                                    <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-300 after:rounded-full after:h-5 after:w-5 after:transition-all switch-toggle"></div>
                                </label>
                            </div>
                        </div>
                        <div id="product-link-container-1" class="input-collapse expanded">
                            <input type="url" class="product-buy-link-input w-full rounded-xl p-3 app-input" placeholder="Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ù†ØªØ¬" value="https://buy.link/product-1">
                        </div>
                    </div>
                </div>
                
                </div>
            <button onclick="publishSite()" class="w-full py-4 text-white font-bold rounded-xl cta-gradient shadow-lg mt-10">Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„Ø£Ø®ÙŠØ±Ø©: Ø£Ù†Ø´Ø¦ Ù…ÙˆÙ‚Ø¹ÙŠ!</button>
        </section>

        <section id="app-stage-4" class="p-6 flex flex-col justify-start items-center flex-grow">
            <div id="loading-state" class="w-full flex flex-col justify-start items-center">
                <div class="w-full text-center">
                    <h2 class="text-3xl font-bold mt-16 mb-6 text-gray-800">Ø¬Ø§Ø±ÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ù…ÙˆÙ‚Ø¹Ùƒ ÙˆÙ†Ø´Ø±Ù‡ Ø§Ù„Ø¢Ù†...</h2>
                    <p class="text-gray-500 mb-12">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± (40 Ø«Ø§Ù†ÙŠØ©)ØŒ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙŠØ¹Ù…Ù„ Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ©.</p>
                </div>
                
                <div class="progress-ring relative flex items-center justify-center mb-10">
                    <svg class="progress-ring" viewBox="0 0 100 100">
                        <circle class="progress-ring__circle" stroke="#E5E7EB" stroke-width="8" fill="transparent" r="46" cx="50" cy="50"/>
                        <circle id="app-progress-indicator" class="progress-ring__circle" stroke="url(#progress-gradient)" stroke-width="8" fill="transparent" r="46" cx="50" cy="50" style="stroke-dasharray: 289; stroke-dashoffset: 289;"/>
                        <defs>
                            <linearGradient id="progress-gradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                <stop offset="0%" style="stop-color:#3B82F6;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#9333EA;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                    </svg>
                    <span id="app-progress-percent" class="absolute text-5xl font-extrabold cta-gradient bg-clip-text text-transparent">0%</span>
                </div>

                <div id="loading-status-list" class="w-full space-y-4 max-w-xs text-right">
                </div>
            </div>

            <div id="final-result-section" class="hidden">
                <i data-lucide="award" class="w-20 h-20 text-yellow-500 mb-4"></i>
                <h2 class="text-3xl font-bold text-gray-800 mb-2">ØªÙ‡Ø§Ù†ÙŠÙ†Ø§! Ù…ÙˆÙ‚Ø¹Ùƒ Ø¬Ø§Ù‡Ø²!</h2>
                
                <div class="my-6 w-full max-w-sm p-4 bg-indigo-50 border-2 border-indigo-200 rounded-xl shadow-inner">
                    <p class="text-sm font-medium text-gray-600 mb-2">Ø±Ø§Ø¨Ø· Ù…ÙˆÙ‚Ø¹Ùƒ (Ø¬Ø§Ù‡Ø² Ù„Ù„Ø±Ø¨Ø· Ø¹Ù„Ù‰ Ù…Ù†ØµØ§ØªÙƒ):</p>
                    <a id="site-link" href="#" target="_blank" class="text-lg font-bold text-indigo-700 break-all hover:underline">Ø³ÙŠØªÙ… ÙˆØ¶Ø¹ Ø±Ø§Ø¨Ø· Ù…ÙˆÙ‚Ø¹Ùƒ Ù‡Ù†Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ù†Ø´Ø±</a>
                </div>

                <div class="bg-red-50 text-red-700 p-3 rounded-lg w-full max-w-sm mb-6 flex items-center justify-center">
                    <i data-lucide="timer" class="w-5 h-5 ml-2"></i>
                    <span id="delete-timer" class="font-bold">Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø³ÙŠØ­Ø°Ù ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯ 05:00</span>
                </div>

                <div class="bg-gray-800 text-white p-5 rounded-xl w-full max-w-sm shadow-2xl space-y-3">
                    <h3 class="text-xl font-bold">Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹Ùƒ ÙˆÙ…ÙŠØ²Ø§ØªÙƒ!</h3>
                    <p class="text-sm">
                        Ù‡Ø°Ø§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø¤Ù‚Øª. ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¯ÙØ¹ **20 Ø¯ÙˆÙ„Ø§Ø±Ù‹Ø§ Ø´Ù‡Ø±ÙŠÙ‹Ø§** ÙÙ‚Ø· Ù„ØªØ­ØµÙ„ Ø¹Ù„Ù‰:
                        <ul class="list-disc list-inside mt-2 text-sm text-gray-300">
                            <li>Ù†Ø·Ø§Ù‚ Ø¯Ø§Ø¦Ù… (Domain)</li>
                            <li>ØªØ­Ù„ÙŠÙ„Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© Ù„Ù„Ù…Ø¨ÙŠØ¹Ø§Øª</li>
                            <li>Ø¯Ø¹Ù… ÙˆØ§ØªØ³Ø§Ø¨ 24/7</li>
                        </ul>
                    </p>
                    <button class="w-full py-3 text-lg font-bold rounded-lg bg-yellow-400 text-gray-900 hover:bg-yellow-500 transition">
                        Ø§Ù„ØªØ±Ù‚ÙŠØ© ÙˆØ§Ù„Ø¯ÙØ¹ Ø§Ù„Ø¢Ù†
                    </button>
                </div>
            </div>
        </section>
    </div>

    <script>
        lucide.createIcons();

        // --- GitHub / Publisher Configuration ---
        // ğŸš¨ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø³Ø±ÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø­Ø³Ø§Ø¨ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Rxwab) - Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø¯ÙØ¹ Ù…Ù† Ø§Ù„Ù…ØªØµÙØ­
        const GitHub_Action_PAT = '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'; 
        const GITHUB_REPO_FULL_NAME = 'Rxwab/WebGen-AI'; 
        const GITHUB_BRANCH = 'main';
        const GITHUB_REQUESTS_DIR = 'requests';
        const PUBLISH_ACCOUNT_NAME = 'GenAI210'; 

        // Landing Page / App UI interaction
        const landingPage = document.getElementById('landing-page');
        const webgenAppUI = document.getElementById('webgen-app-ui');
        const appStages = ['app-stage-1', 'app-stage-2', 'app-stage-3', 'app-stage-4'];
        const stepTitles = ['step-title-1', 'step-title-2', 'step-title-3', 'step-title-4'];
        const progressBar = document.getElementById('app-progress-bar');
        const siteLinkElement = document.getElementById('site-link');
        let currentAppStage = 1;

        // Timer variables for stage 4 completion
        let deleteTimerInterval;

        // --- Core App Navigation ---
        function startApp() {
            landingPage.classList.add('hidden');
            webgenAppUI.classList.remove('hidden');
            nextAppStage(1); // Start at stage 1
        }

        function hideAllAppStages() {
            appStages.forEach(id => {
                document.getElementById(id).classList.add('hidden');
            });
        }

        function updateProgressBar(stageNumber) {
            const widthPercentage = (stageNumber / appStages.length) * 100;
            progressBar.style.width = widthPercentage + '%';
            
            stepTitles.forEach((id, index) => {
                const stepElement = document.getElementById(id);
                if (index < stageNumber) {
                    stepElement.classList.remove('text-gray-500');
                    stepElement.classList.add('text-indigo-600');
                } else {
                    stepElement.classList.remove('text-indigo-600');
                    stepElement.classList.add('text-gray-500');
                }
            });
        }

        function nextAppStage(stageNumber) {
            hideAllAppStages();
            const nextId = 'app-stage-' + stageNumber;
            document.getElementById(nextId).classList.remove('hidden');
            currentAppStage = stageNumber;
            updateAppHeaderVisibility();
            updateProgressBar(stageNumber);
        }

        function goBack() {
            // Stop timer if user navigates back from final result screen
            clearInterval(deleteTimerInterval);
            if (currentAppStage > 1) {
                nextAppStage(currentAppStage - 1);
            } else {
                // If on stage 1, go back to landing page
                webgenAppUI.classList.add('hidden');
                landingPage.classList.remove('hidden');
            }
        }

        function updateAppHeaderVisibility() {
            const backButton = webgenAppUI.querySelector('header button');
            if (currentAppStage > 1) {
                backButton.classList.remove('hidden');
            } else {
                backButton.classList.add('hidden');
            }
        }

        // --- Final Result Logic ---
        function startDeleteTimer() {
            const duration = 5 * 60; // 5 minutes in seconds
            let timer = duration;
            const display = document.getElementById('delete-timer');

            function updateTimer() {
                const minutes = Math.floor(timer / 60);
                const seconds = timer % 60;
                
                // Format the time as MM:SS
                const formattedTime = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                display.textContent = `Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø³ÙŠØ­Ø°Ù ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¨Ø¹Ø¯ ${formattedTime}`;

                if (--timer < 0) {
                    timer = 0;
                    clearInterval(deleteTimerInterval);
                    display.textContent = 'ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…ÙˆÙ‚Ø¹ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§.';
                    // Optional: redirect user or show a "deleted" screen
                }
            }

            // Clear any existing interval before starting a new one
            clearInterval(deleteTimerInterval); 
            
            // Set the interval to update every second
            deleteTimerInterval = setInterval(updateTimer, 1000);
            updateTimer(); // Initial call to display immediately
        }

        function showFinalResult(repoName) {
            document.getElementById('loading-state').classList.add('hidden');
            document.getElementById('final-result-section').classList.remove('hidden');
            
            const finalURL = `https://${PUBLISH_ACCOUNT_NAME}.github.io/${repoName}/`;
            siteLinkElement.href = finalURL;
            siteLinkElement.textContent = finalURL;
            
            startDeleteTimer();
        }
        
        // --- Stage 3: Image Upload Preview Logic ---
        function previewImage(input, preview, placeholder) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();

                reader.onload = function (e) {
                    preview.src = e.target.result;
                    preview.classList.remove('hidden');
                    placeholder.classList.add('hidden'); // Hide the icon/text placeholder
                }

                reader.readAsDataURL(input.files[0]);
            } else {
                preview.src = "";
                preview.classList.add('hidden');
                placeholder.classList.remove('hidden'); // Show the icon/text placeholder if file is cleared
            }
        }

        // --- Stage 1 & 3: Link Field Toggle Animation ---
        function toggleLinkField(checkbox) {
            const containerId = checkbox.getAttribute('data-link-id');
            const container = document.getElementById(containerId);
            if (checkbox.checked) {
                container.classList.add('expanded');
            } else {
                container.classList.remove('expanded');
            }
        }

        // --- Stage 2: Card Selection Logic ---
        function selectCard(element) {
            element.classList.toggle('selected');
        }

        // --- Stage 4: 40-Second Loading Simulation ---
        const loadingSteps = [
            { title: "Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ù…Ø¯Ø®Ù„Ø§ØªÙƒ ÙˆØ§Ø®ØªÙŠØ§Ø± Ø£ÙØ¶Ù„ Ø¨Ù†ÙŠØ© ØªØµÙ…ÙŠÙ…ÙŠØ©", duration: 7000 },
            { title: "Ø¨Ø¯Ø¡ ÙƒØªØ§Ø¨Ø© Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙˆÙ…Ù‚Ø§Ø·Ø¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ (AI Content)", duration: 8000 },
            { title: "ØªØ¬Ù…ÙŠØ¹ ØµÙˆØ± Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ÙˆØªØ­Ø³ÙŠÙ† Ø¬ÙˆØ¯ØªÙ‡Ø§ ÙˆØ£Ø­Ø¬Ø§Ù…Ù‡Ø§", duration: 5000 },
            { title: "Ø¥Ø¹Ø¯Ø§Ø¯ ØªØ­Ø³ÙŠÙ† Ù…Ø­Ø±ÙƒØ§Øª Ø§Ù„Ø¨Ø­Ø« (SEO) Ù„Ù„Ù…Ø­ØªÙˆÙ‰", duration: 6000 },
            { title: "ØªÙƒÙˆÙŠÙ† Ø´Ù‡Ø§Ø¯Ø© SSL ÙˆØ­Ù…Ø§ÙŠØ© Ø§Ù„Ù…ÙˆÙ‚Ø¹", duration: 4000 },
            { title: "Ù†Ø´Ø± Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ø´Ø¨ÙƒØ© Ø§Ù„ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ø§Ù„Ù…ÙŠØ© (CDN)", duration: 10000 }
        ];
        const totalDuration = 40000; // 40 seconds total

        function simulateLoading(repoName) {
            const radius = 46;
            const totalCircumference = 2 * Math.PI * radius;
            const progressIndicator = document.getElementById('app-progress-indicator');
            const progressPercentText = document.getElementById('app-progress-percent');
            const statusListContainer = document.getElementById('loading-status-list');
            
            // Initial setup
            progressIndicator.style.strokeDashoffset = totalCircumference;
            progressIndicator.style.strokeDasharray = totalCircumference;
            statusListContainer.innerHTML = '';
            
            let startTime = null;
            let stepIndex = 0;

            function updateProgress(timestamp) {
                if (!startTime) startTime = timestamp;
                const progress = timestamp - startTime;
                
                const percentage = Math.min(100, (progress / totalDuration) * 100);
                
                // 1. Update Circle and Text
                const offset = totalCircumference - percentage / 100 * totalCircumference;
                progressIndicator.style.strokeDashoffset = offset;
                progressPercentText.textContent = `${Math.floor(percentage)}%`;

                // 2. Update Status List
                if (stepIndex < loadingSteps.length) {
                    const stepCompletedAt = loadingSteps.slice(0, stepIndex + 1).reduce((sum, step) => sum + step.duration, 0);

                    if (progress >= stepCompletedAt) {
                        // Mark previous step as complete (check mark)
                        const completedStatusElement = document.getElementById(`step-${stepIndex - 1}-status`);
                        if (completedStatusElement) {
                            completedStatusElement.innerHTML = `<i data-lucide="check-circle" class="w-5 h-5 text-green-500"></i>`;
                            lucide.createIcons();
                        }

                        // Move to the next step
                        stepIndex++;

                        if (stepIndex <= loadingSteps.length) {
                            const nextStep = loadingSteps[stepIndex - 1];
                            const statusHtml = `
                                <div id="step-${stepIndex - 1}" class="flex items-center justify-between py-3 border-b border-gray-100">
                                    <span class="text-lg text-gray-700 flex items-center">
                                        <i data-lucide="zap" class="w-5 h-5 ml-2 text-indigo-500"></i>
                                        ${nextStep.title}
                                    </span>
                                    <span id="step-${stepIndex - 1}-status"><i data-lucide="loader-2" class="w-5 h-5 text-gray-400 animate-spin"></i></span>
                                </div>`;
                            // Append the new status element to the list
                            statusListContainer.innerHTML += statusHtml;
                            lucide.createIcons(); // Re-render icons for new content
                        }
                    }
                }

                if (percentage < 100) {
                    requestAnimationFrame(updateProgress);
                } else {
                    // Final state adjustments (CRITICAL: showFinalResult is here only)
                    progressPercentText.textContent = 'ØªÙ…!';
                    // Final checkmark for the last step
                    const finalElement = document.getElementById(`step-${loadingSteps.length - 1}-status`);
                    if (finalElement) {
                        finalElement.innerHTML = `<i data-lucide="check-circle" class="w-5 h-5 text-green-500"></i>`;
                        lucide.createIcons();
                    }
                    showFinalResult(repoName); // Show final result with generated repo name
                }
            }
            
            // Manually trigger the first step outside the loop to ensure it appears immediately
            const initialStep = loadingSteps[0];
            const initialHtml = `
                <div id="step-0" class="flex items-center justify-between py-3 border-b border-gray-100">
                    <span class="text-lg text-gray-700 flex items-center">
                        <i data-lucide="zap" class="w-5 h-5 ml-2 text-indigo-500"></i>
                        ${initialStep.title}
                    </span>
                    <span id="step-0-status"><i data-lucide="loader-2" class="w-5 h-5 text-gray-400 animate-spin"></i></span>
                </div>`;
            statusListContainer.innerHTML = initialHtml;
            lucide.createIcons();
            
            // Start the main animation loop
            requestAnimationFrame(updateProgress);
        }

        // --- Core Publishing Function ---
        function slugify(text) {
            text = text.toLowerCase();
            text = text.replace(/[^a-z0-9\s-]/g, ''); 
            text = text.replace(/[\s]+/g, '-');       
            return text.trim('-');
        }
        
        async function pushFile(fileName, content, commitMessage) {
            const url = `https://api.github.com/repos/${GITHUB_REPO_FULL_NAME}/contents/${GITHUB_REQUESTS_DIR}/${fileName}`;
            
            // ğŸš¨ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø§Ø³Ù…: Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¢Ù† ØªØ±Ù…ÙŠØ² UTF-8 Ø¨Ø´ÙƒÙ„ ØµØ±ÙŠØ­ Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
            const contentBytes = new TextEncoder().encode(content);
            const base64Content = btoa(String.fromCharCode.apply(null, contentBytes));
            // Ù†Ù‡Ø§ÙŠØ© Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­Ø§Ø³Ù…

            try {
                const response = await fetch(url, {
                    method: 'PUT',
                    headers: {
                        'Authorization': `token ${GitHub_Action_PAT}`,
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        message: commitMessage,
                        content: base64Content,
                        branch: GITHUB_BRANCH,
                    }),
                });

                if (response.ok) {
                    console.log('JSON file pushed successfully.');
                    return true;
                } else {
                    const errorData = await response.json();
                    console.error('Failed to push JSON:', response.status, errorData);
                    alert('ÙØ´Ù„ Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ GitHub. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø³Ø±ÙŠ (PAT).');
                    return false;
                }
            } catch (error) {
                console.error('Network or system error during push:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø­Ø§ÙˆÙ„Ø© Ø±ÙØ¹ Ù…Ù„Ù Ø§Ù„Ø·Ù„Ø¨.');
                return false;
            }
        }
        
        async function publishSite() {
            // 1. Get Input Data
            const siteName = document.getElementById('app-site-name').value;
            const productTitle = document.querySelector('.product-title-input').value;
            const productDesc = document.querySelector('.product-desc-input').value;
            const productPrice = document.querySelector('.product-price-input').value;
            const productCurrency = document.querySelector('.product-currency-input').value;
            const buyLink = document.querySelector('.product-buy-link-input').value;
            const whatsappLink = document.getElementById('app-whatsapp-link').value;

            if (!siteName || !productTitle || !productDesc) {
                alert('Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø¥Ù„Ø²Ø§Ù…ÙŠØ© ÙÙŠ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©.');
                return;
            }
            
            // For simplicity, we hardcode a placeholder image URL for now
            const productImageURL = "https://via.placeholder.com/600x800.png?text=WebGen+AI+Product";
            
            const requestData = {
                site_name: siteName,
                product_title: productTitle,
                product_price: `${productPrice} ${productCurrency.split(' ')[1] || ''}`,
                product_image_url: productImageURL,
                product_desc: productDesc,
                buy_link: buyLink,
                whatsapp_link: whatsappLink
            };
            
            const repoSlug = slugify(siteName);
            const fileName = `${repoSlug}-${Date.now()}.json`;
            
            // 2. Switch to Loading Screen
            nextAppStage(4); 

            // 3. Push the JSON file
            const pushSucceeded = await pushFile(
                fileName,
                JSON.stringify(requestData, null, 2),
                `WebGen: Create request file for ${productTitle}`
            );

            // 4. Start Loading Simulation (which finishes by showing the result)
            if (pushSucceeded) {
                simulateLoading(repoSlug); 
            } else {
                // If push failed, we must go back to the input screen
                goBack();
                alert('ÙØ´Ù„ Ø§Ù„Ù†Ø´Ø±: ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ§Øª Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø³Ø±ÙŠ ÙÙŠ index.html.');
            }
        }

        // Ensure initial elements are set up
        document.addEventListener('DOMContentLoaded', () => {
            // Set initial state for the progress bar
            updateProgressBar(1);
            
            // Close all collapse containers on load
            document.querySelectorAll('.input-collapse').forEach(el => {
                el.classList.remove('expanded');
            });

            // Expand default product link
            document.getElementById('product-link-container-1').classList.add('expanded');
        });
    </script>

</body>
</html>
